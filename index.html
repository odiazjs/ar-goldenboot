<!DOCTYPE html>
<html>

<head>
  <title>
    AR Demo
  </title>

  <style>
  </style>

  <meta name="description" content="balondioro">
  <meta name="viewport" content="width=device-width, user-scalable=no, minimum-scale=1.0, maximum-scale=1.0">

  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/4.7.0/css/font-awesome.min.css">
  <link rel="stylesheet" href="/css/all.min.css">
  <link rel="stylesheet" href="/css/flexboxgrid.min.css">
  <link rel="stylesheet" type="text/css" href="/css/animate.css">
  <link rel="stylesheet" type="text/css" href="/css/styles.css">

  <script type="module" src="https://unpkg.com/@google/model-viewer@0.3.1/dist/model-viewer.js">
  </script>

  <script nomodule src="https://unpkg.com/@google/model-viewer@0.3.1/dist/model-viewer-legacy.js">
  </script>

  <script src="https://aframe.io/releases/1.0.3/aframe.min.js"></script>
  <script src="./js/hammer.js"></script>
  <script src="/aframe.js"></script>
  <script src="/script.js"></script>
  <script src="/js/app.js"></script>

  <script>

    let markerFound = false;
    let loader = null;

    AFRAME.registerComponent('registerevents', {
      init: function () {
        var marker = this.el;

        // Make the element emit events when found and when lost.
        marker.setAttribute('emitevents', 'true');

        marker.addEventListener('markerFound', function () {
          var markerId = marker.id;
          markerFound = true;
          console.log('markerFound', markerId);
        });

        marker.addEventListener('markerLost', function () {
          var markerId = marker.id;
          markerFound = false;
          console.log('markerLost', markerId);
        });
      }
    });
    AFRAME.registerComponent('modelonload', {
      init: function () {
        loader = document.querySelector("#spinner");
        this.el.addEventListener('model-loaded', e => {
          console.log('loaded !!!!!!! ');
        })
      },
      tick: function () {
        if (markerFound && loader) {
          setTimeout(() => {
            loader.style.display = "none";
          }, 200);
        } else {
          setTimeout(() => {
            loader.style.display = "";
          }, 200);
        }
      }
    });
  </script>

</head>

<body style='margin : 0px; overflow: hidden;'>

  <div id="spinner" class="loading">
    <div class="loader"></div>
  </div>

  <!-- FC Barcelona Brand Start -->
  <div class="header">
    <div class="row">
      <div class="col-xs-3">
        <img class="logo" src="./assets/fcblogo.png" alt="fcb logo" />
      </div>
      <div class="col-xs-9">
        <a href="#" class="title">BARCELONA AR EXPERIENCE</a>
      </div>
    </div>
  </div>

  <footer>
    <!-- <model-viewer 
      background-color="#293e77" 
      ios-src="./assets/goldenboot/Botin de Oro Messi.usdz" 
      src="./assets/locker-room/SM_LockerRoom.gltf"
      alt="6to botin de oro de Messi" 
      ar 
      style="width: 100%; height: 100%;" camera-controls>
    </model-viewer> -->
    <div class="row" style="min-height: 100%;">
      <div class="col-xs-3">
        <i class="fas fa-lock"></i>
      </div>
      <div class="col-xs-3">
        col 2
      </div>
      <div class="col-xs-3">
        col 3
      </div>
      <div class="col-xs-3">
        col 4
      </div>
    </div>
    <div class="row" style="margin: 60px 20px;">
      <img id="model-stats" class="fcblogo" style="max-width: 325px;" src="./assets/copa-champios.png"
        alt="model statistics" />
    </div>
  </footer>

  <!-- FC Barcelona Brand End -->

  <a-scene embedded arjs='sourceType: webcam;'
    renderer="colorManagement: true; physicallyCorrectLights: true; logarithmicDepthBuffer: true; sortObjects: false;">

    <a-assets>
      <a-entity src="/assets/botin-oro/Botin de Oro.gltf" id="golden-boot"></a-entity>
      <a-entity src="/assets/iniesta/Zapato Iniesta.gltf" id="iniesta-boot"></a-entity>
      <video id="goldenboot-1" autoplay loop="true" src="./assets/videos/oro-intro.mp4?r=10"></video>
    </a-assets>

    <a-marker id="a-marker-0" listener interaction media hammer registerevents emitevents="true"
      cursor="rayOrigin: mouse" type='pattern' url='./assets/markers/pattern-goldenboot.patt'>
    </a-marker>

    <a-entity id="target" gltf-model="#golden-boot" position="-0.14671 -1.37996 -8.10592" modelonload rotation="20 0 0"
      scale="0.5 0.5 0.5" visible="">
    </a-entity>

    <a-video src="#goldenboot-1" width="16" height="9" position="0 0 -20" rotation="0 0 0"></a-video>

    <!-- <a-marker id="a-marker-1" listener2 interaction media hammer registerevents emitevents="true"
      cursor="rayOrigin: mouse" type='pattern' url='./assets/pattern-image.patt'>
    </a-marker>

    <a-entity id="target2" gltf-model="soda-can" position="-0.14671 -1.37996 -8.10592" modelonload rotation="20 0 0"
      scale="5 5 5" visible="">
    </a-entity> -->

    <a-camera-static />

    <a-light id="spot-light" type="spot" color="white"
      light="type: point; color: #ffffff; intensity: 20; penumbra: 1; castShadow: true; shadowBias: 1"
      position="-0.09255 1.68958 -4.47987" rotation="">
    </a-light>

  </a-scene>

</body>

</html>